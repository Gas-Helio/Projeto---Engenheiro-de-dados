SELECT [UF] as Localidade, COUNT(IDAtracacao) - (SELECT COUNT(IDAtracacao) FROM atracacao_fato WHERE [Ano da data de início da operação] = Fa.[Ano da data de início da operação] - 1 and UF = Fa.UF and [Mês da data de início da operação] = Fa.[Mês da data de início da operação]) as [Variação do número de atracação em relação ao mesmo mês do ano anterior],  COUNT(IDAtracacao) as [Número de Atracações], AVG(TEsperaDesatracacao) as [Tempo de espera médio], AVG(TAtracado) as [Tempo atracado médio], [Mês da data de início da operação] as Mês, [Ano da data de início da operação] as Ano FROM atracacao_fato as Fa WHERE [Ano da data de início da operação] IN (2018, 2019) GROUP BY UF, [Ano da data de início da operação], [Mês da data de início da operação];